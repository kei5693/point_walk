<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<title>테스트</title>
	<link rel="stylesheet" href="./css/swiper-bundle.min.css">
	<link rel="stylesheet" href="./css/reset.css">
	<link rel="stylesheet" href="./css/animation.css">
	<link rel="stylesheet" href="./css/common.css">

	<script src="./js/swiper-bundle.min.js"></script>

	<script src="./js/cdn.jsdelivr.net_npm_chart.js"></script>

	<script src="./js/masonry.pkgd.min.js"></script>
	<script src="https://unpkg.com/imagesloaded@5/imagesloaded.pkgd.min.js"></script>
	<script src="https://unpkg.com/infinite-scroll@3/dist/infinite-scroll.pkgd.js"></script>

	<script src="./js/lottie-player.js"></script>
</head>

<body>

	<div id="wrap" class="test_wrap">

		<div class="lottie_player">
			<lottie-player
				autoplay
				loop
				mode="normal"
				src="./json/animation_lo2isjhu.json"
				>
				
				<!--
					controls
					src="./json/animation_lo2isjhu.json"
				-->
			</lottie-player>

			<!-- <lottie-player
				autoplay
				loop
				controls
				mode="normal"
				src="./json/lf20_UJNc2t.json"
			>
			</lottie-player> -->
		</div>

		<style>
			.lottie_player {
				border: 5px solid #000;
			}
		</style>

		<script>
			const player = document.querySelector("lottie-player");
			// player.load("./json/lf20_UJNc2t.json");

			player.addEventListener('ready', function(){
				var svg = player.shadowRoot.querySelector("svg");
				// svg.setAttribute("viewBox", "0 0 800 800"); 

				svg.setAttribute("viewBox", "-177 150 750 450"); 
				svg.setAttribute("height", "450");
			});


			
			// console.log(svg);
			

			// svg.setAttribute('preserveAspectRatio', 'xMidYMid slice');
		</script>







		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		
		<div class="design_select">
			<p class="selected"><span>option1</span></p>
			<ul class="optionList">
				<li class="select"><span>option1</span></li>
				<li><span>option2</span></li>
				<li><span>option3</span></li>
			</ul>
		</div>
		
		<div class="design_select">
			<p class="selected"><span>option4</span></p>
			<ul class="optionList">
				<li class="select"><span>option4</span></li>
				<li><span>option5</span></li>
				<li><span>option6</span></li>
			</ul>
		</div>






		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>



		<div>
			<canvas id="myChart"></canvas>
		</div>
		<script>
			const ctx = document.getElementById('myChart');
			var myChart = new Chart(ctx, {
				type: 'doughnut',
				data: {
					datasets: [{
						data: [8, 2],
						backgroundColor: [
							'red',
							'transparent',
						],
					}, {
						data: [7, 3],
						backgroundColor: [
							'blue',
							'transparent',
						],
						// borderRadius: 60,
						// borderWidth: 0,
					},]
				},
				options: {
					responsive: true,
				},
				// plugins: [{
				// 	afterUpdate: function (chart) {
				// 		const arcs = chart.getDatasetMeta(0).data;

				// 		console.log(chart.getDatasetMeta(0));

				// 		arcs.forEach(function (arc) {
				// 			arc.round = {
				// 				x: (chart.chartArea.left + chart.chartArea.right) / 2,
				// 				y: (chart.chartArea.top + chart.chartArea.bottom) / 2,
				// 				radius: (arc.outerRadius + arc.innerRadius) / 2,
				// 				thickness: (arc.outerRadius - arc.innerRadius) / 2,
				// 				backgroundColor: arc.options.backgroundColor
				// 			}
				// 		});
				// 	},
				// 	afterDraw: (chart) => {
				// 		const {
				// 			ctx,
				// 			canvas
				// 		} = chart;

				// 		chart.getDatasetMeta(0).data.forEach(arc => {
				// 			const startAngle = Math.PI / 2 - arc.startAngle;
				// 			const endAngle = Math.PI / 2 - arc.endAngle;

				// 			ctx.save();
				// 			ctx.translate(arc.round.x, arc.round.y);
				// 			ctx.fillStyle = arc.options.backgroundColor;
				// 			ctx.beginPath();
				// 			ctx.arc(arc.round.radius * Math.sin(endAngle), arc.round.radius * Math.cos(endAngle), arc.round.thickness, 0, 2 * Math.PI);
				// 			ctx.closePath();
				// 			ctx.fill();
				// 			ctx.restore();
				// 		});
				// 	}
				// }]
			});
		</script>

		<!-- <canvas id="myChart"></canvas>
		<script>
			// round corners
			Chart.pluginService.register({
				afterUpdate: function (chart) {
					if (chart.config.options.elements.arc.roundedCornersFor !== undefined) {
						var arc = chart.getDatasetMeta(0).data[chart.config.options.elements.arc.roundedCornersFor];
						arc.round = {
							x: (chart.chartArea.left + chart.chartArea.right) / 2,
							y: (chart.chartArea.top + chart.chartArea.bottom) / 2,
							radius: (chart.outerRadius + chart.innerRadius) / 2,
							thickness: (chart.outerRadius - chart.innerRadius) / 2 - 1,
							backgroundColor: arc._model.backgroundColor
						}
					}
				},

				afterDraw: function (chart) {
					if (chart.config.options.elements.arc.roundedCornersFor !== undefined) {
						var ctx = chart.chart.ctx;
						var arc = chart.getDatasetMeta(0).data[chart.config.options.elements.arc.roundedCornersFor];
						var startAngle = Math.PI / 2 - arc._view.startAngle;
						var endAngle = Math.PI / 2 - arc._view.endAngle;

						ctx.save();
						ctx.translate(arc.round.x, arc.round.y);
						console.log(arc.round.startAngle)
						ctx.fillStyle = arc.round.backgroundColor;
						ctx.beginPath();
						ctx.arc(arc.round.radius * Math.sin(startAngle), arc.round.radius * Math.cos(startAngle), arc.round.thickness, 0, 2 * Math.PI);
						ctx.arc(arc.round.radius * Math.sin(endAngle), arc.round.radius * Math.cos(endAngle), arc.round.thickness, 0, 2 * Math.PI);
						ctx.closePath();
						ctx.fill();
						ctx.restore();
					}
				},
			});

			// write text plugin
			Chart.pluginService.register({
				afterUpdate: function (chart) {
					if (chart.config.options.elements.center) {
						var helpers = Chart.helpers;
						var centerConfig = chart.config.options.elements.center;
						var globalConfig = Chart.defaults.global;
						var ctx = chart.chart.ctx;

						var fontStyle = helpers.getValueOrDefault(centerConfig.fontStyle, globalConfig.defaultFontStyle);
						var fontFamily = helpers.getValueOrDefault(centerConfig.fontFamily, globalConfig.defaultFontFamily);

						if (centerConfig.fontSize)
							var fontSize = centerConfig.fontSize;
						// figure out the best font size, if one is not specified
						else {
							ctx.save();
							var fontSize = helpers.getValueOrDefault(centerConfig.minFontSize, 1);
							var maxFontSize = helpers.getValueOrDefault(centerConfig.maxFontSize, 256);
							var maxText = helpers.getValueOrDefault(centerConfig.maxText, centerConfig.text);

							do {
								ctx.font = helpers.fontString(fontSize, fontStyle, fontFamily);
								var textWidth = ctx.measureText(maxText).width;

								// check if it fits, is within configured limits and that we are not simply toggling back and forth
								if (textWidth < chart.innerRadius * 2 && fontSize < maxFontSize)
									fontSize += 1;
								else {
									// reverse last step
									fontSize -= 1;
									break;
								}
							} while (true)
							ctx.restore();
						}

						// save properties
						chart.center = {
							font: helpers.fontString(fontSize, fontStyle, fontFamily),
							fillStyle: helpers.getValueOrDefault(centerConfig.fontColor, globalConfig.defaultFontColor)
						};
					}
				},
				afterDraw: function (chart) {
					if (chart.center) {
						var centerConfig = chart.config.options.elements.center;
						var ctx = chart.chart.ctx;

						ctx.save();
						ctx.font = chart.center.font;
						ctx.fillStyle = chart.center.fillStyle;
						ctx.textAlign = 'center';
						ctx.textBaseline = 'middle';
						var centerX = (chart.chartArea.left + chart.chartArea.right) / 2;
						var centerY = (chart.chartArea.top + chart.chartArea.bottom) / 2;
						ctx.fillText(centerConfig.text, centerX, centerY);
						ctx.restore();
					}
				},
			})


			var config = {
				type: 'doughnut',
				data: {
					labels: [
						"Red",
						"Gray"
					],
					datasets: [{
						data: [67, 33],
						backgroundColor: [
							"#FF6684",
							"#ccc"
						],
						hoverBackgroundColor: [
							"#FF6384",
							"#ccc"
						]
					}]
				},
				options: {
					elements: {
						arc: {
							roundedCornersFor: 0
						},
						center: {
							// the longest text that could appear in the center
							maxText: '100%',
							text: '67%',
							fontColor: '#FF6684',
							fontFamily: "'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",
							fontStyle: 'normal',
							// fontSize: 12,
							// if a fontSize is NOT specified, we will scale (within the below limits) maxText to take up the maximum space in the center
							// if these are not specified either, we default to 1 and 256
							minFontSize: 1,
							maxFontSize: 256,
						}
					}
				}
			};

			var ctx = document.getElementById("myChart").getContext("2d");
			var myChart = new Chart(ctx, config);
		</script> -->





		<!-- circle_progress -->
		<div class="circle_progress_wrap">
			<svg class="circle_progress" viewBox="0 0 150 150">
				<circle class="frame" cx="50%" cy="50%" r="54" stroke-width="12" />
				<circle class="bar" cx="50%" cy="50%" r="54" stroke-width="12" />
			</svg>
			
			<input id="control" type="range" value="30" />
			<strong class="value"></strong>
		</div>
		<!-- //circle_progress -->






		<!-- swiper -->
		<div class="swiper scale_swiper">
			<div class="swiper-wrapper">
				<div class="swiper-slide">Slide 1</div>
				<div class="swiper-slide">Slide 2</div>
				<div class="swiper-slide">Slide 3</div>
				<div class="swiper-slide">Slide 4</div>
				<div class="swiper-slide">Slide 5</div>
			</div>

			<!-- If we need pagination -->
			<!-- <div class="swiper-pagination"></div> -->

			<!-- If we need navigation buttons -->
			<div class="swiper-button-prev"></div>
			<div class="swiper-button-next"></div>

			<!-- If we need scrollbar -->
			<!-- <div class="swiper-scrollbar"></div> -->
		</div>
		<!-- //swiper -->

		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>

		<!-- Swiper -->
    <div class="swiper mySwiper">
      <div class="swiper-wrapper">
        <div class="swiper-slide"><img src="https://swiperjs.com/demos/images/nature-1.jpg" /></div>
        <div class="swiper-slide"><img src="https://swiperjs.com/demos/images/nature-2.jpg" /></div>
        <div class="swiper-slide"><img src="https://swiperjs.com/demos/images/nature-3.jpg" /></div>
        <div class="swiper-slide"><img src="https://swiperjs.com/demos/images/nature-4.jpg" /></div>
        <div class="swiper-slide"><img src="https://swiperjs.com/demos/images/nature-5.jpg" /></div>
        <div class="swiper-slide"><img src="https://swiperjs.com/demos/images/nature-6.jpg" /></div>
        <div class="swiper-slide"><img src="https://swiperjs.com/demos/images/nature-7.jpg" /></div>
        <div class="swiper-slide"><img src="https://swiperjs.com/demos/images/nature-8.jpg" /></div>
        <div class="swiper-slide"><img src="https://swiperjs.com/demos/images/nature-9.jpg" /></div>
      </div>
      <!-- <div class="swiper-pagination"></div> -->
    </div>
		<script>
      var swiper = new Swiper(".mySwiper", {
				loop: true,
        centeredSlides: true,
        slidesPerView: 1.4,

				spaceBetween: 30,
				grabCursor: true,
        effect: "coverflow",
        coverflowEffect: {
          rotate: 5,
          slideShadows: true
        },
        // pagination: {
        //   el: ".swiper-pagination"
        // }
      });
    </script>




		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>








		<!-- number count -->
		<div class="number_count">
			<div class="value">100</div>
			<div class="value">100</div>
			<div class="value">100</div>
			<div class="value">100</div>
		</div>
		<!-- //number count -->







		<div class="grid_wrap">
			<div class="grid-sizer"></div>
			<div class="grid-item"><span>1</span><img src="https://i.pinimg.com/236x/7e/40/54/7e40545d9e395d983bc3ad5a5193ea87.jpg" alt=""></div>
			<div class="grid-item"><span>2</span><img src="https://i.pinimg.com/236x/ee/bf/26/eebf263cb85614e2b39bcb3e5aff6272.jpg" alt=""></div>
			<div class="grid-item"><span>3</span><img src="https://i.pinimg.com/236x/5f/e8/71/5fe871675ae4b1522844469051b1ba66.jpg" alt=""></div>
			<div class="grid-item"><span>4</span><img src="https://i.pinimg.com/236x/1d/76/bf/1d76bfff1dd5026241ffbd4956f6f718.jpg" alt=""></div>
			<div class="grid-item"><span>5</span><img src="https://i.pinimg.com/236x/1f/f2/4d/1ff24d7ebbae1a4eef4a76861f979994.jpg" alt=""></div>
			<div class="grid-item"><span>6</span><img src="https://i.pinimg.com/236x/92/a3/52/92a35232a5a9abae976e971f57fe1ccf.jpg" alt=""></div>
			<div class="grid-item"><span>7</span><img src="https://i.pinimg.com/236x/24/e1/bd/24e1bda77a465bc9462566d5aaa006d8.jpg" alt=""></div>
			<div class="grid-item"><span>8</span><img src="https://i.pinimg.com/236x/ed/4b/d9/ed4bd93a5375ac63f29736451e38801b.jpg" alt=""></div>
			<div class="grid-item"><span>9</span><img src="https://i.pinimg.com/236x/00/5e/51/005e517222ecb274147c19db09a54f12.jpg" alt=""></div>
			<div class="grid-item"><span>10</span><img src="https://i.pinimg.com/236x/50/01/40/500140a2117bad5badf02c422393e547.jpg" alt=""></div>
			<div class="grid-item"><span>11</span><img src="https://i.pinimg.com/236x/35/6d/78/356d78b9775a25aed8c472aa261727ef.jpg" alt=""></div>
			<div class="grid-item"><span>12</span><img src="https://i.pinimg.com/236x/91/75/4c/91754ca61d9f29a5c64cf69a5fd59bfe.jpg" alt=""></div>
			<div class="grid-item"><span>13</span><img src="https://i.pinimg.com/236x/da/14/7a/da147a764f2e39828373f342fbe246e8.jpg" alt=""></div>
			<div class="grid-item"><span>14</span><img src="https://i.pinimg.com/236x/00/2a/83/002a838bc6a06e7220c5334a66fa2045.jpg" alt=""></div>
			<div class="grid-item"><span>15</span><img src="https://i.pinimg.com/236x/e2/d5/ff/e2d5ff4d4852f8cb281e426959329831.jpg" alt=""></div>
			<div class="grid-item"><span>16</span><img src="https://i.pinimg.com/236x/37/eb/14/37eb144773e0ef3971ecf7b96d51954f.jpg" alt=""></div>
			<div class="grid-item"><span>17</span><img src="https://i.pinimg.com/236x/0f/15/d6/0f15d6350163a4608a48fb73ccac21f7.jpg" alt=""></div>
			<div class="grid-item"><span>18</span><img src="https://i.pinimg.com/236x/cc/3c/42/cc3c4255a31630605fecea3db663cc9d.jpg" alt=""></div>
			<div class="grid-item"><span>19</span><img src="https://i.pinimg.com/236x/d9/d5/d1/d9d5d1993f3daaef3f10ed1d2f45761b.jpg" alt=""></div>
			<div class="grid-item"><span>20</span><img src="https://i.pinimg.com/236x/6d/00/97/6d00973bca2e5d5429b0fe45ef39cf58.jpg" alt=""></div>
		</div>
	
		<script>
			var elem = document.querySelector('.grid_wrap');
			var msnry = new Masonry( elem, {
				itemSelector: '.grid-item',
				columnWidth: '.grid-sizer',
				percentPosition: true,
				visibleStyle: { transform: 'translateY(0)', opacity: 1 },
				hiddenStyle: { transform: 'translateY(100px)', opacity: 0 },
				// horizontalOrder: true,
				// gutter: 20,
			});

			imagesLoaded( '.grid_wrap' ).on( 'progress', function() {
				msnry.layout();
			});

			function scrollAddItem(){
				const newItems = createNewItems();
				elem.appendChild(newItems);
				msnry.reloadItems();
				msnry.layout();
			}

			window.addEventListener('scroll', () => {
				if(isScrollNearBottom){
					scrollAddItem();
				}
			});

			function isScrollNearBottom() {
				const scrollY = window.scrollY || window.pageYOffset;
				const viewportHeight = window.innerHeight;
				const contentHeight = document.documentElement.scrollHeight;
				const buffer = 200; // Adjust this buffer value to your preference
				return contentHeight - (scrollY + viewportHeight) < buffer;
			}
		
			function createNewItems() {
				const fragment = document.createDocumentFragment();
				let imgArr = [
					'https://i.pinimg.com/236x/7e/40/54/7e40545d9e395d983bc3ad5a5193ea87.jpg',
					'https://i.pinimg.com/236x/ee/bf/26/eebf263cb85614e2b39bcb3e5aff6272.jpg',
					'https://i.pinimg.com/236x/5f/e8/71/5fe871675ae4b1522844469051b1ba66.jpg',
					'https://i.pinimg.com/236x/1d/76/bf/1d76bfff1dd5026241ffbd4956f6f718.jpg',
					'https://i.pinimg.com/236x/1f/f2/4d/1ff24d7ebbae1a4eef4a76861f979994.jpg'
				];

				for (let i = 0; i < 5; i++) {
					const newItem = document.createElement('div');
					newItem.className = 'grid-item';
					// Add content or image with a data-src attribute for LazyLoad
					newItem.innerHTML = `<span>${i}</span><img src=${imgArr[i]} alt="">`;
					fragment.appendChild(newItem);
				}
				return fragment;
			}
		</script>
	</div>





	<script>
		let counters = document.querySelectorAll('.number_count .value');

		animateCounter(counters[0], 50);
		// animateCounter(counters[1], 95);
		// animateCounter(counters[2], 999);
		// animateCounter(counters[3], 9999);

		function animateCounter(counter, targetValue) {
			let startValue = parseInt(counter.innerText);
			let duration = 1000;
			let increment = (targetValue - startValue) / duration;

			// console.log(increment); -0.05
			let qwe = 0;

			// Update counter
			let startTimestamp;
			function updateCounter(timestamp) {
				if (!startTimestamp) startTimestamp = timestamp;
				let elapsedTime = timestamp - startTimestamp;


				//console.log(++qwe, timestamp, startTimestamp, elapsedTime);


				if (elapsedTime < duration) {
					let newValue = Math.round(startValue + increment * elapsedTime);
					counter.textContent = newValue;
					requestAnimationFrame(updateCounter);
				} else {
					// Set the final value as the targetValue
					counter.textContent = targetValue;
				}
			}

			// Start the animation
			requestAnimationFrame(updateCounter);
		}
	</script>
	<script src="./js/common.js"></script>
	<script>
		common.circleProgress('control', '.bar', '.value');
		bottomSheetModal(".show-modal", ".bottom-sheet");
	</script>
</body>
</html>